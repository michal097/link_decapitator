<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Link decapitator</title>
    <link th:href="@{/css/style.css}" rel="stylesheet" />
    <script type="text/javascript" th:src="@{/js/angularController.js}"></script>
    <script type="text/javascript" th:src="@{/js/copy.js}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
    <script src="../static/js/angularController.js"
            th:src="@{/js/angularController.js}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-messages.js">
    </script>
</head>


<body ng-app="app" >

<form th:action="@{/save}" th:object="${link}" method="post">
    <h1> Enter the URL to shorten</h1>
    <div class="linkInput">
        <input type="text" placeholder="enter some url adress" style="color: dimgrey; font-size: 20px;" th:field="*{originalName}"/>
    </div>
    <button class="button" type="submit" value="SHORT!!!">Get short link</button>
</form>

<div class="result" th:if="${mess}" >
    <p>Your short link:
        <input type="text" th:value="${mess}" id="myInput" readonly>
        <button class="copy_button"onclick="myFunction()">Copy text</button>
    </p>
</div>
<div class="errors" th:if="${err}">
    <p th:text="${err}">err</p>
</div>

<div class="content" ng-controller="UserCRUDCtrl">

    <button class="button_del" ng-click="showDelete = ! showDelete">Delete link</button>

    <div ng-show = "showDelete">

        <p>
            <label for="id">
            </label><input class="delete_input" type="text" placeholder="Enter delete key" style="color: dimgrey" id="id" ng-model="link.deleteKey" />
            <button class="button_delete" ng-click="deleteUser(link.deleteKey)"> Delete chosen link</button>
            <br>


    </div>

    <div class="errors" th:if="${delErr}">
        <p th:text="${delErr}">err</p>
    </div>

    <button class="button_get_all" ng-click="getAllLinks();showDetails = ! showDetails">Get all links</button><br/><br/>
    <div ng-show="showDetails">
        <table>
            <thead>
            <tr>
                <th>Original URL</th>
                <th>New URL</th>
                <th>Number of visits</th>
                <th>Delete key</th>
                <th>IP</th>

            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="link in links">
                <td>{{link.originalName}}</td>
                <td>s91.herokuapp.com/{{link.newName}}</td>
                <td>{{link.counter}}</td>
                <td>{{link.deleteKey}}</td>
                <td>{{link.ip}}</td>
            </tr>
            </tbody>
        </table>

    </div>
</div>

</body>
</html>